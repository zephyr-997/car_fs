C251 COMPILER V5.60.0,  encoder                                                            13/05/25  11:27:02  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE encoder
OBJECT MODULE PLACED IN .\Out_File\encoder.obj
COMPILER INVOKED BY: D:\Software\Keil5\c251v560\C251\BIN\C251.EXE ..\USER\src\encoder.c XSMALL WARNINGLEVEL(3) OPTIMIZE(
                    -0,SPEED) BROWSE INCDIR(..\CODE;..\USER\inc;..\USER\src;..\seekfree_components;..\seekfree_libraries;..\seekfree_peripher
                    -al;..\libraries) DEBUG PRINT(.\Out_File\encoder.lst) TABS(2) OBJECT(.\Out_File\encoder.obj) 

stmt  level    source

    1          #include "encoder.h"
    2          
    3          int g_encoleft_init = 0, g_encoright_init = 0;
    4          int g_EncoderLeft = 0, g_EncoderRight = 0;
    5          int g_intencoderALL = 0, g_intencoderL = 0, g_intencoderR = 0;
    6          
    7          
    8          EncoderDebo_t EncoderDeboL, EncoderDeboR;
    9          
   10          
   11          void encoder_init(void)
   12          {
   13   1        ctimer_count_init(CTIM0_P34);
   14   1        ctimer_count_init(CTIM3_P04);
   15   1        
   16   1        EncoderDeboL.encoderlast = 0;
   17   1        EncoderDeboL.count = 0;
   18   1        
   19   1        EncoderDeboR.encoderlast = 0;
   20   1        EncoderDeboR.count = 0;
   21   1      }
   22          
   23          
   24          int get_left_encoder(void)
   25          {
   26   1        int encoder_left;
   27   1        
   28   1        if(LEFT_DIR == 1)
   29   1        {
   30   2          encoder_left = ctimer_count_read(CTIM0_P34);
   31   2        }
   32   1        else
   33   1        {
   34   2          encoder_left = ctimer_count_read(CTIM0_P34) * -1;
   35   2        }
   36   1        
   37   1        ctimer_count_clean(CTIM0_P34);
   38   1        
   39   1        return encoder_left;
   40   1      }
   41          
   42          
   43          int get_right_encoder(void)
   44          {
   45   1        int encoder_right;
   46   1        
   47   1        if(RIGHT_DIR == 1)
   48   1        {
   49   2          encoder_right = ctimer_count_read(CTIM3_P04) * -1;
   50   2        }
   51   1        else
   52   1        {
   53   2          encoder_right = ctimer_count_read(CTIM3_P04);
   54   2        }
   55   1        
   56   1        ctimer_count_clean(CTIM3_P04);
   57   1        
C251 COMPILER V5.60.0,  encoder                                                            13/05/25  11:27:02  PAGE 2   

   58   1        return encoder_right;
   59   1      }
   60          
   61          int encoder_debounce(EncoderDebo_t* instance, int encoder)
   62          {
   63   1        if (myabs(encoder - instance->encoderlast) > 20 && instance->count >= 5)
   64   1        {
   65   2          encoder = instance->encoderlast;
   66   2          instance->count = 0;
   67   2        }
   68   1        else
   69   1        {
   70   2          instance->encoderlast = encoder;
   71   2          
   72   2          instance->count++;
   73   2          if (instance->count >= 10000)
   74   2          {
   75   3            instance->count = 0;
   76   3          }
   77   2        }
   78   1        
   79   1        return encoder;
   80   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       264     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =        32     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =        42     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
